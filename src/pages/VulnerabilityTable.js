import React from "react";
import { Link } from "react-router-dom";
import "bootstrap/dist/css/bootstrap.min.css";
import { Table, Button, Modal } from "react-bootstrap";

const vulnerabilities = [
  { id: 1, app: "WordPress", vuln: "SQL Injection", cve: "CVE-2023-12345", severity: "Critical", cvss: 9.8, version: "5.8", status: "Open" },
  { id: 2, app: "Apache", vuln: "Remote Code Execution", cve: "CVE-2023-23456", severity: "High", cvss: 8.5, version: "2.4.48", status: "Open" },
  { id: 3, app: "Nginx", vuln: "Buffer Overflow", cve: "CVE-2023-34567", severity: "Medium", cvss: 6.4, version: "1.20.1", status: "In Progress" },
  { id: 4, app: "Joomla", vuln: "Cross-Site Scripting", cve: "CVE-2023-45678", severity: "Low", cvss: 4.3, version: "3.9.0", status: "Fixed" },
  { id: 5, app: "Drupal", vuln: "XML Injection", cve: "CVE-2023-56789", severity: "Critical", cvss: 9.1, version: "9.2.3", status: "Open" },
  { id: 6, app: "Magento", vuln: "CSRF", cve: "CVE-2023-67890", severity: "High", cvss: 8.1, version: "2.4.2", status: "In Progress" },
  { id: 7, app: "Django", vuln: "Session Hijacking", cve: "CVE-2023-78901", severity: "Medium", cvss: 6.2, version: "3.2.5", status: "Fixed" },
  { id: 8, app: "Laravel", vuln: "Weak Authentication", cve: "CVE-2023-89012", severity: "Low", cvss: 3.9, version: "8.12", status: "Open" },
  { id: 9, app: "Spring Boot", vuln: "Insecure Deserialization", cve: "CVE-2023-90123", severity: "Critical", cvss: 9.5, version: "2.5.0", status: "Open" },
  { id: 10, app: "Node.js", vuln: "Insecure Dependencies", cve: "CVE-2023-91234", severity: "High", cvss: 7.8, version: "14.17.6", status: "In Progress" },
  { id: 11, app: "Express.js", vuln: "Security Misconfiguration", cve: "CVE-2023-92345", severity: "Medium", cvss: 5.5, version: "4.17.1", status: "Fixed" },
  { id: 12, app: "Flask", vuln: "Insecure Transport", cve: "CVE-2023-93456", severity: "Low", cvss: 3.5, version: "2.0.1", status: "Open" },
  { id: 13, app: "Rails", vuln: "Broken Access Control", cve: "CVE-2023-94567", severity: "Critical", cvss: 9.3, version: "6.1.3", status: "Open" },
  { id: 14, app: "Symfony", vuln: "Insecure API", cve: "CVE-2023-95678", severity: "High", cvss: 8.0, version: "5.3.6", status: "In Progress" },
  { id: 15, app: "React", vuln: "DOM-based XSS", cve: "CVE-2023-96789", severity: "Medium", cvss: 6.0, version: "17.0.2", status: "Fixed" },
];

const severityColors = {
  Critical: "bg-red-600 text-white",
  High: "bg-orange-500 text-white",
  Medium: "bg-yellow-400 text-black",
  Low: "bg-green-500 text-white",
};

const VulnerabilityTable = () => {
  const handleDetailsClick = (id) => {
    alert(`Details clicked for vulnerability ID: ${id}`);
  };

  return (
    <div id="content" className="app-content">
    <ul className="breadcrumb">
      <li className="breadcrumb-item"><Link to="/dashboard">Home</Link></li>
      <li className="breadcrumb-item active">VulnerabilityTable </li>
    </ul>
    
    <h1 className="page-header">
    Application Vulnerability   <small></small>
    </h1>
    <div className="row ">
      {/* <h2 className="text-xl font-bold mb-4">Application Vulnerabilities</h2> */}
      <div className="col-md-12">
      <Table striped bordered hover responsive>

        {/* <table className=" striped bordered hover responsive table   border w-full"> */}
        <thead className="table-dark">
            <tr className=" border-b">
              <th className="p-2 text-left">Application</th>
              <th className="p-2 text-left">Vulnerability</th>
              <th className="p-2 text-left">CVE</th>
              <th className="p-2 text-left">Severity</th>
              <th className="p-2 text-left">CVSS Score</th>
              <th className="p-2 text-left">Status</th>
              <th className="p-2 text-left">Actions</th>
            </tr>
          </thead>
          <tbody>
            {vulnerabilities.map((vuln) => (
              <tr key={vuln.id} className="border-b">
                <td className="">{vuln.app}</td>
                <td className="">{vuln.vuln}</td>
                <td className="">
                  <a
                    href={`https://cve.mitre.org/cgi-bin/cvename.cgi?name=${vuln.cve}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    className=" btn text-blue-600 hover:underline"
                  >
                    {vuln.cve}
                  </a>
                </td>
                <td className={`badge  text-center ${severityColors[vuln.severity]} rounded`}>{vuln.severity}</td>
                <td className="">{vuln.cvss}</td>
                <td className="">{vuln.status}</td>
                <td className="">
                  <button
                    onClick={() => handleDetailsClick(vuln.id)}
                    className="btn btn-primary btn-sm rounded hover:bg-blue-700"
                  >
                    View Details
                  </button>
                </td>
              </tr>
            ))}
          </tbody>
        </Table>
      </div>
    </div>
    </div>
  );
};

export default VulnerabilityTable;
